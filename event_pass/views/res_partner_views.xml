<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_partner_form_pass_inherit" model="ir.ui.view">
        <field name="name">base.view_partner_form_pass_inherit</field>
        <field name="model">res.partner</field>
        <field name="priority" eval="20"/>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='internal_notes']" position="before">
                <page name="pass_line" string="Pass">
                    <group name="pass" string="Pass Invitation">
                        <field name="pass_line_ids" nolabel="1">
                            <tree>
                                <field name="display_name"/>
                                <field name="validity_date"/>
                                <field name="expiration_date"/>
                                <field name="event_type_ids" widget="many2many_tags"/>
                                <field name="category_ids" widget="many2many_tags"
                                       options="{'color_field': 'color'}"/>
                                <field name="event_stage_ids" widget="many2many_tags"/>
                                <field name="event_ids" widget="many2many_tags" optional="hide"/>
                                <field name="session_ids" widget="many2many_tags" optional="hide"/>
                                <field name="number_allowed_event" optional="hide"/>
                                <field name="number_visitors" optional="hide"/>
                            </tree>
                        </field>
                    </group>
                </page>
            </xpath>
            <xpath expr="//field[@name='vat']" position="after">
                <field name="barcode"/>
            </xpath>
        </field>
    </record>

    <record id="action_view_event_pass_line" model="ir.actions.act_window">
        <field name="res_model">event.pass.line</field>
        <field name="name">Pass</field>
        <field name="view_mode">tree</field>
        <field name="domain">[('partner_id', '=', active_id)]</field>
    </record>

    <record id="res_partner_view_tree_pass" model="ir.ui.view">
        <field name="name">view.res.partner.form.pass.inherited</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
<!--        <field name="groups_id" eval="[(5,)]"/>-->
        <field name="priority" eval="6"/>
        <field name="arch" type="xml">
            <div name="button_box" position="inside">
                <button
                        name="%(action_view_event_pass_line)d"
                        class="oe_stat_button"
                        type="action"
                        icon="fa-id-card-o"
                        attrs="{'invisible': [('pass_count','=', 0)]}">
                    <field string="Pass" name="pass_count" widget="statinfo"/>
                </button>
            </div>
        </field>
    </record>

</odoo>