<?xml version="1.0"?>
<odoo>
    <data>

        <!-- PASS.TYPE ACTIONS -->
        <record model="ir.actions.act_window" id="act_menu_pass_type">
            <field name="name">Pass Templates</field>
            <field name="res_model">event.pass.type</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a new pass template.
                </p>
            </field>
        </record>

        <!-- HEADER: CONFIGURATION -->
        <menuitem name="Pass Templates"
                  id="menu_pass_type"
                  sequence="4"
                  action="act_menu_pass_type"
                  groups="event.group_event_user"
                  parent="event.menu_event_configuration"/>


        <!-- PASS.TYPE VIEWS -->
        <record model="ir.ui.view" id="view_event_pass_type_form">
            <field name="name">event.pass.type.form</field>
            <field name="model">event.pass.type</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <div class="oe_button_box" name="button_box"/>
                        <div class="oe_title">
                            <h1>
                                <field name="display_name" id="field_display_name"/>
                            </h1>
                        </div>
                        <group>
                            <group name="allowed_events" string="Allowed Events">
                                <field name="event_type_ids" widget="many2many_tags" id="field_event_type_ids"/>
                                <field name="category_ids" widget="many2many_tags" options="{'color_field': 'color'}" id="field_category_ids"/>
                                <field name="event_stage_ids" widget="many2many_tags" id="field_event_stage_ids"/>
                                <field name="event_ids" widget="many2many_tags" id="field_event_ids"/>
                                <field attrs="{'invisible': [('event_ids', '=', [])]}" name="session_ids"
                                    widget="many2many_tags" domain="[('event_id', 'in', event_ids)]" id="field_session_ids"/>
                                <field attrs="{'invisible': [('event_ids', '=', [])]}" name="unauthorized_session_ids"
                                    widget="many2many_tags" domain="[('event_id', 'in', event_ids)]" id="field_unauthorized_session_ids"/>
                            </group>

                                <!-- <group>
                                    <label for="use_validity_dates" string="Validity Options"/>
                                    <div class="d-flex">
                                        <field name="fixed_expiration_date" id="field_fixed_expiration_date" string="Use Fixed Expiration Date"/>
                                        <field name="validity_period" id="field_validity_period" placeholder="Validity Period (Days)"
                                            attrs="{'invisible': [('fixed_expiration_date', '=', True)]}"/>
                                    </div>
                                </group> -->
                                <!-- ICI -->
                                <group name="validity_dates" string="Validity Dates">
                                    <group>
                                        <field name="validity_option" widget="radio" string="Validity Option"
                                            selection="[
                                                ('fixed', 'Fixed Date Range'),
                                                ('variable', 'Variable in Days')
                                            ]"/>
                                            <div class="o_row" colspan="4">
                                            <label for="validity_date" string="Dates" attrs="{'invisible': [('validity_option', '!=', 'fixed')]}"/>
                                                <div class="o_row" attrs="{'invisible': [('validity_option', '!=', 'fixed')]}" >
                                                    <field name="validity_date" widget="daterange" nolabel="1" class="oe_inline"
                                                    options="{'related_end_date': 'expiration_date'}"/>
                                                <i class="fa fa-long-arrow-right mx-2" aria-label="Arrow icon" title="Arrow"/>
                                                <field name="expiration_date" widget="daterange" nolabel="1" class="oe_inline"
                                                    options="{'related_start_date': 'validity_date'}"/>
                                                </div>
                                            </div>

                                        <div attrs="{'invisible': [('validity_option', '!=', 'variable')]}" colspan="4" class="oe_inline o_row">
                                            <label for="validity_period" string="Validity Period in Days"/>
                                                <field name="validity_period" placeholder="Leave empty for infinite period"/>   
                                        </div>
                                    </group>
                                </group>
                            </group>

                            <group>
                                <group name="event_limitations" string="Passage Limitations" colspan="4">
                                    <label for="fixed_number_allowed_event" string="Limit Number of Events"/>
                                    <div>
                                        <field name="fixed_number_allowed_event" widget="boolean"/>
                                            <span attrs="{'invisible': [('fixed_number_allowed_event', '=', False)]}">
                                            to
                                            <field name="number_allowed_event" class="oe_inline o_input_9ch"/>
                                            Maximum Number of Events
                                            </span>
                                    </div>

                                    <label for="fixed_number_visitors_allowed" string="Limit Number of Visitors"/>
                                    <div>
                                        <field name="fixed_number_visitors_allowed" widget="boolean"/>
                                            <span attrs="{'invisible': [('fixed_number_visitors_allowed', '=', False)]}">
                                            to
                                            <field name="number_visitors" class="oe_inline o_input_9ch"/>
                                            Maximum Number of Visitors
                                            </span>
                                    </div>
                                </group>
                            </group>

                            <notebook>
                                <page string="Customization">
                                    <group name="general_customization" string="General Customization">
                                        <group>
                                            <field name="outline_color" widget="color" id="field_outline_color"/>
                                            <field name="background_color" widget="color" id="field_background_color"/>
                                        </group>
                                        <group name="upper_left" string="Upper Left Page">
                                            <field name="upper_left_text" widget="html" options="{'codeview':true}"
                                                id="field_upper_left_text"/>
                                        </group>
                                        <group name="upper_right" string="Upper Right Page">
                                            <field name="base_logo" widget="html" options="{'codeview':true}"
                                                id="field_base_logo"/>
                                            <field name="title_text" id="field_title_text"/>
                                            <field name="title_color" widget="color" id="field_title_color"/>
                                            <field name="content_color" widget="color" id="field_content_color"/>
                                        </group>
                                        <group name="bottom_left" string="Bottom Left Page">
                                            <field name="bottom_left_text" widget="html" options="{'codeview':true}"
                                                id="field_bottom_left_text"/>
                                        </group>
                                        <group name="bottom_right" string="Bottom Right Page">
                                            <field name="bottom_right_text" widget="html" options="{'codeview':true}"
                                                id="field_bottom_right_text"/>
                                        </group>
                                    </group>
                                </page>
                            </notebook>
                    </sheet>
                </form>
            </field>
        </record>




        <record model="ir.ui.view" id="view_event_pass_type_tree">
            <field name="name">event.pass.type.tree</field>
            <field name="model">event.pass.type</field>
            <field name="arch" type="xml">
                <tree string="Pass Template">
                    <field name="display_name"/>
                </tree>
            </field>
        </record>

        <record id="event_pass_type_view_search" model="ir.ui.view">
            <field name="name">event.pass.type.search</field>
            <field name="model">event.pass.type</field>
            <field name="arch" type="xml">
                <search string="Pass Templates">
                    <field name="display_name"/>
                </search>
            </field>
        </record>

    </data>
</odoo>
